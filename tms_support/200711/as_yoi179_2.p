def var msisdns AS CHARACTER NO-UNDO init "622000152 622000154 622000156 622000158 622000160 622000162 622000164 622000166 622000168 622000170 622000172 622000174 622000176 622000178 622000180 622000182 622000184 622000186 622000188 622000190 622000192 622000194 622000222 622000256 622000300 622000400 622000410 622000421 622000466 622000470 622000508 622000544 622000555 622000607 622001005 622001039 622040040 622040226 622040250 622040296 622100138 622100169 622201500 622201900 622207900 622208200 622208500 622209900 622210200 622210700 622211200 622213200 622213300 622217300 622237600 622238700 622239300 622239400 622239600 622241200 622241300 622241400 622241500 622241600 622241800 622241900 622242100 622242300 622242700 622242800 622242900 622243100 622243200 622243300 622243400 622243500 622243600 622243700 622243900 622244300 622244500 622244600 622244700 622244800 622244900 622245100 622245200 622245300 622245400 622245600 622245800 622245900 622246300 622246400 622246500 622246600 622246700 622246900 622247100 622247200 622247300 622247400 622247500 622247600 622247700 622247800 622247900 622248100 622248200 622248300 622248400 622248500 622248600 622248700 622248900 622249100 622249200 622249300 622249400 622249500 622249600 622249700 622249800 622249900 622250100 622250200 622250400 622250900 622251000 622251300 622251400 622251600 622251700 622251800 622251900 622252100 622252200 622252300 622252700 622252800 622252900 622253100 622253200 622253300 622253400 622253600 622253700 622253800 622253900 622254100 622254200 622254300 622254500 622254700 622254800 622255100 622255300 622255400 622255600 622255700 622255800 622255900 622256100 622256200 622256300 622256400 622256500 622256600 622256700 622256800 622256900 622257100 622257200 622257300 622257400 622257500 622257600 622257700 622257800 622257900 622258100 622258200 622258400 622258500 622258600 622258700 622258900 622259100 622259200 622259300 622259400 622259500 622259600 622259700 622259800 622260100 622260300 622260500 622260900 622261000 622261100 622261300 622261400 622261500 622261600 622261700 622261800 622261900 622262400 622262500 622262600 622262700 622262800 622263100 622263200 622263400 622263500 622263600 622263700 622263900 622264200 622264300 622264600 622264700 622264800 622264900 622265100 622265200 622265300 622265400 622265700 622265800 622266100 622266300 622266400 622266500 622266800 622267100 622267200 622267300 622267400 622267500 622267600 622267700 622267800 622267900 622268100 622268200 622268300 622268400 622268500 622268700 622268800 622268900 622269100 622269200 622269300 622269400 622269500 622269600 622269700 622269800 622269900 622270100 622270200 622270300 622271200 622271300 622271400 622271500 622271600 622271700 622271900 622272100 622272200 622272400 622272500 622272600 622272800 622272900 622273100 622273200 622273400 622273500 622273800 622273900 622274100 622274200 622274300 622274400 622274500 622274600 622274700 622274800 622274900 622275100 622275300 622275400 622275500 622275600 622275700 622275800 622275900 622276000 622276100 622276200 622276300 622276400 622276500 622276600 622276700 622276800 622276900 622277100 622277200 622277500 622277600 622277800 622277900 622278000 622278100 622278200 622278300 622278400 622278500 622278700 622278800 622279100 622279200 622279300 622279400 622279500 622279600 622279700 622279800 622279900 622280300 622280400 622280600 622280700 622281100 622281300 622281400 622281500 622281600 622281700 622281800 622281900 622282100 622282300 622282400 622282500 622282700 622282900 622283100 622283200 622283300 622283400 622283500 622283600 622283700 622283800 622283900 622284100 622284200 622284300 622284400 622284500 622284600 622284700 622284800 622284900 622285100 622285200 622285300 622285400 622285500 622285600 622285700 622285800 622285900 622286100 622286200 622286300 622286500 622286600 622286700 622286800 622286900 622287000 622287100 622287200 622287300 622287400 622287600 622287700 622287800 622287900 622288300 622288600 622288700 622288900 622289000 622289100 622289200 622289300 622289400 622289500 622289600 622289700 622289800 622290300 622290400 622290500 622290800 622291100 622291300 622291400 622291500 622291600 622291700 622291800 622291900 622292100 622292200 622292400 622292500 622293100 622293200 622293300 622293400 622293500 622293600 622293700 622293900 622294000 622294100 622294300 622294400 622294500 622294600 622294800 622294900 622295100 622295200 622295300 622295400 622295500 622295600 622295700 622295800 622296100 622296200 622296300 622296400 622296500 622296700 622296800 622296900 622297000 622297100 622297200 622297300 622297400 622297500 622297600 622297700 622297800 622297900 622298100 622298200 622298300 622298400 622298500 622298600 622298700 622298800 622298900 622299100 622299200 622299300 622299400 622299500 622299600 622299700 622299800 622301200 622301400 622301500 622301600 622301800 622302200 622302400 622302500 622302700 622302800 622302900 622303400 622303500 622303600 622303700 622303800 622303900 622304100 622304200 622304300 622304400 622304500 622304600 622304700 622304800 622304900 622305200 622305300 622305400 622305500 622305600 622305700 622306100 622306200 622306300 622306400 622306500 622306800 622306900 622307100 622307300 622307400 622307600 622307800 622307900 622308100 622308200 622308400 622308500 622308600 622308700 622308800 622308900 622309100 622309200 622309300 622309400 622309500 622309600 622309700 622309800 622309900 622310300 622310400 622310500 622310600 622310700 622310800 622310900 622311100 622311200 622311300 622311400 622311500 622311600 622311700 622311800 622311900 622312100 622312300 622312400 622312500 622312700 622312800 622312900 622313200 622313300 622313400 622313500 622313600 622313700 622313800 622314000 622314100 622314300 622314500 622314800 622314900 622315100 622315200 622315300 622315400 622315500 622315600 622315700 622315800 622316000 622316100 622316200 622316300 622316400 622316500 622316600 622316800 622316900 622317200 622317300 622317400 622317500 622317600 622317800 622317900 622318100 622318200 622318300 622318400 622318500 622318600 622318700 622318800 622318900 622319000 622319100 622319200 622319300 622319400 622319500 622319600 622319700 622319800 622319900 622320100 622320300 622320400 622320500 622320600 622320700 622320800 622320900 622321100 622321200 622321300 622321400 622321500 622321600 622321900 622322100 622322400 622322700 622322900 622323100 622323400 622323500 622323600 622323700 622323800 622323900 622324000 622324100 622324300 622324400 622324500 622324600 622324700 622324800 622324900 622325100 622325200 622325300 622325400 622325500 622325600 622325700 622325800 622326100 622326200 622326300 622326400 622326500 622326600 622326700 622326800 622326900 622327000 622327100 622327200 622327300 622327400 622327500 622327600 622327700 622327800 622327900 622328100 622328200 622328300 622328400 622328500 622328600 622328700 622328800 622328900 622329000 622329200 622329300 622329400 622329500 622329600 622329700 622329800 622330100 622330300 622330400 622330500 622330600 622330700 622330800 622331200 622331300 622331400 622331500 622331600 622331700 622331800 622331900 622332300 622332400 622332500 622332600 622332700 622332800 622332900 622333100 622333500 622333600 622333800 622334000 622334100 622334200 622334300 622334500 622334600 622334700 622334800 622334900 622335100 622335200 622335300 622335400 622335600 622335700 622335800 622335900 622336100 622336200 622336300 622336400 622336500 622336700 622336800 622336900 622337000 622337100 622337200 622337300 622337400 622337500 622337600 622337800 622337900 622338100 622338200 622338300 622338400 622338500 622338600 622338700 622338900 622339100 622339200 622339300 622339400 622339500 622339600 622339700 622339800 622340100 622340300 622340400 622340500 622340600 622340700 622340800 622340900 622341100 622401200 622401300 622401400 622401500 622401600 622401700 622401800 622401900 622402100 622402300 622402400 622402500 622402600 622402700 622402800 622402900 622403100 622403200 622403300 622403400 622403500 622403600 622403800 622403900 622404100 622404200 622404300 622200015 622200020 622200021 622200095 622200121 622200129 622200130 622200166 622200172 622200181 622200191 622200193 622200194 622200196 622200197 622200204 622200212 622200214 622200216 622200218 622200231 622200237 622200255 622200280 622200282 622200283 622200284 622200309 622200310 622200312 622200316 622200317 622200318 622200325 622200329 622200332 622200338 622200393 622200395 622200397 622200398 622200412 622200414 622200431 622200432 622200433 622200443 622200447 622200455 622200461 622200462 622200471 622200482 622200487 622200497 622200507 622200509 622200532 622200554 622200560 622200562 622200569 622200572 622200578 622200580 622200591 622200601 622200603 622200609 622200613 622200624 622200638 622200639 622200641 622200642 622200644 622200654 622200658 622200661 622200663 622200674 622200675 622200678 622200685 622200691 622200693 622200714 622200726 622200728 622200729 622200734 622200739 622200741 622200745 622200753 622200757 622200758 622200771 622200773 622200779 622200784 622200787 622200793 622200814 622200833 622200844 622200849 622200864 622200865 622200867 622200868 622200875 622200877 622200882 622200885 622200909 622200919 622200921 622200931 622200932 622200940 622201030 622201045 622201054 622201055 622201058 622201064 622201067 622201071 622201074 622201085 622201092 622201093 622201118 622201124 622201125 622201128 622201129 622201131 622201140 622201152 622201164 622201178 622201181 622201182 622201198 622201208 622201210 622201224 622201247 622201249 622201254 622201268 622201283 622201285 622201288 622201306 622201310 622201319 622201328 622201334 622201347 622201352 622201353 622201354 622201364 622201370 622201381 622201391 622201417 622201446 622201471 622201486 622201487 622201503 622201511 622201518 622201522 622201523 622201525 622201540 622201550 622201561 622201567 622201582 622201587 622201590 622201597 622201603 622201609 622201613 622201621 622201651 622201652 622201653 622201654 622201655 622201665 622201671 622201693 622201705 622201709 622201713 622201730 622201741 622201751 622201762 622201765 622201788 622201795 622201802 622201821 622201823 622201826 622201834 622201841 622201853 622201863 622201864 622201866 622201869 622201871 622201882 622201890 622201894 622201906 622201908 622201911 622201917 622201968 622201978 622201988 622201993 622201998 622202011".
DEFINE VARIABLE lcmsisdn AS CHARACTER NO-UNDO.
DEFINE VARIABLE k AS INTEGER NO-UNDO. 
k = NUM-ENTRIES(msisdns," ").
DEFINE VARIABLE i AS INTEGER NO-UNDO. 
DEFINE VARIABLE j AS INTEGER NO-UNDO.
def buffer msisdn2 for msisdn.

def stream excel.
OUTPUT STREAM excel TO "/apps/snet/200711/as_yoi179_2.txt".
put stream excel unformatted "CLI STATUS ACTIONDATE VALIDFROM VALIDTO" skip.

do i = 1 TO k:
   lcmsisdn = entry(i,msisdns, " ").
   find first order where order.cli = lcmsisdn NO-LOCK no-error.
   if avail order then do:
     find first termmobsub where termmobsub.cli = order.cli NO-LOCK no-error. 
     if avail termmobsub then do:
         find killms where killms.msseq = termmobsub.msseq NO-LOCK 
         no-error.
         IF AVAIL killms and killms.outoper ne ""  then do:
            j = j + 1.
            find msisdn where msisdn.cli = lcmsisdn NO-LOCK.
            
            put stream excel unformatted msisdn.cli + " 6 " +  string(killms.killdate) + 
            " " + string(killms.killdatets) + " 99999999.99999" skip.
             
            create msisdn2.
            buffer-copy msisdn except validfrom to msisdn2.
            assign
               msisdn2.validto = 99999999.99999 
               msisdn2.validfrom = killms.killdatets
               msisdn2.actiondate = killms.killdate
               msisdn2.statuscode = 6.
         END.   
     end.    
   end.
end.
output close.
output stream excel close.


